{"id":205,"date":"2021-06-03T14:35:48","date_gmt":"2021-06-03T18:35:48","guid":{"rendered":"http:\/\/localhost\/homepage\/?page_id=205"},"modified":"2023-10-05T13:15:30","modified_gmt":"2023-10-05T17:15:30","slug":"a-step-towards-conscious-planning","status":"publish","type":"page","link":"http:\/\/localhost\/homepage\/a-step-towards-conscious-planning\/","title":{"rendered":"A Consciousness-Inspired Planning Agent for Model-Based Reinforcement Learning"},"content":{"rendered":"\n<p class=\"has-text-align-center has-small-font-size\">Mingde Zhao, Zhen Liu, Sitao Luan, Shuyuan Zhang, Doina Precup, Yoshua Bengio<\/p>\n\n\n\n<p class=\"has-text-align-center\">(<a href=\"https:\/\/arxiv.org\/abs\/2106.02097\" data-type=\"URL\" data-id=\"https:\/\/arxiv.org\/abs\/2106.02097\">arXiv<\/a> \/ <a href=\"https:\/\/github.com\/PwnerHarry\/CP\" data-type=\"URL\" data-id=\"https:\/\/github.com\/PwnerHarry\/CP\">GitHub<\/a> \/ <a href=\"https:\/\/youtu.be\/vC1SEroKNDY\" data-type=\"URL\" data-id=\"https:\/\/youtu.be\/vC1SEroKNDY\">YouTube<\/a>)<\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><a href=\"http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/12\/CP_Poster.png\"><img loading=\"lazy\" decoding=\"async\" width=\"1024\" height=\"576\" src=\"http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/12\/CP_Poster-1024x576.png\" alt=\"\" class=\"wp-image-352\" srcset=\"http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/12\/CP_Poster-1024x576.png 1024w, http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/12\/CP_Poster-300x169.png 300w, http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/12\/CP_Poster-768x432.png 768w, http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/12\/CP_Poster-1536x864.png 1536w, http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/12\/CP_Poster-2048x1152.png 2048w, http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/12\/CP_Poster-520x293.png 520w, http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/12\/CP_Poster-880x495.png 880w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \/><\/a><\/figure>\n\n\n\n<p class=\"has-medium-font-size\"><em>[NeurIPS 2021] This paper received media coverage from <a href=\"https:\/\/medium.com\/syncedreview\/yoshua-bengio-team-designs-consciousness-inspired-planning-agent-for-model-based-rl-501b4d7e80f5\" data-type=\"URL\" data-id=\"https:\/\/medium.com\/syncedreview\/yoshua-bengio-team-designs-consciousness-inspired-planning-agent-for-model-based-rl-501b4d7e80f5\">Synced Review<\/a>,  <a href=\"https:\/\/mila.quebec\/en\/article\/a-consciousness-inspired-planning-agent-for-model-based-reinforcement-learning\/\">The Mila Blog<\/a> (available in English &amp; French), <a href=\"https:\/\/www.marktechpost.com\/2021\/06\/18\/ai-researchers-including-yoshua-bengio-introduce-a-consciousness-inspired-planning-agent-for-model-based-reinforcement-learning\/\" data-type=\"URL\" data-id=\"https:\/\/www.marktechpost.com\/2021\/06\/18\/ai-researchers-including-yoshua-bengio-introduce-a-consciousness-inspired-planning-agent-for-model-based-reinforcement-learning\/\">MarkTechPost<\/a>, etc.<\/em><\/p>\n\n\n\n<p class=\"has-medium-font-size\">We introduce into reinforcement learning inductive biases inspired by higher-order cognitive functions in humans. These architectural constraints enable the planning to direct attention dynamically to the interesting parts of the state at each step of imagined future trajectories.<\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-large is-resized\"><img loading=\"lazy\" decoding=\"async\" src=\"http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/06\/image-1.png\" alt=\"\" class=\"wp-image-233\" style=\"width:610px;height:500px\" width=\"610\" height=\"500\"\/><figcaption class=\"wp-element-caption\"><em>A birdseye view of the overall design<\/em><\/figcaption><\/figure><\/div>\n\n\n<p>Whether when planning our paths home from the office or from a hotel to an airport in an unfamiliar city, we typically focus on a small subset of relevant variables, e.g. the change in position or the presence of traffic. An interesting hypothesis of how this path planning skill generalizes across scenarios is that it may be due to computation associated with the conscious processing of information. Conscious attention focuses on a few necessary environment elements, with the help of an internal abstract representation of the world. This pattern, also known as consciousness in the first sense (C1), has been theorized to enable humans\u2019 exceptional adaptability and learning efficiency. A central characterization of conscious processing is that it involves a bottleneck, which forces one to handle dependencies between very few characteristics of the environment at a time. Though this focus on a small subset of the available information may seem limiting, it may facilitate Out-Of-Distribution (OOD) and systematic generalization toother situations where the ignored variables are different and yet still irrelevant. In this paper, we propose an architecture which allows us to encode some of these ideas into reinforcement learning agents.<\/p>\n\n\n\n<p>Our proposal is to take inspiration from human consciousness to build an architecture which learns a useful state space and in which attention can be focused on a small set of variables at any time. This idea of \u201cpartial planning\u201d is enabled by modern deep RL techniques. Specifically, we propose an end-to-end latent-space MBRL agent which does not require reconstructing the observations, as in most existing works, and uses Model Predictive Control (MPC) for decision-time planning. From an observation, the agent encodes a set of objects as a state, with a selective attention bottleneck mechanism to plan over selected subsets of the state (Sec. 4). Our experiments show that the inductive biases improve a specific form of OOD generalization, where consistent dynamics are preserved across seemingly different environment settings (Sec. 5).<\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-large\"><img loading=\"lazy\" decoding=\"async\" width=\"886\" height=\"209\" src=\"http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/06\/image.png\" alt=\"\" class=\"wp-image-229\" srcset=\"http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/06\/image.png 886w, http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/06\/image-300x71.png 300w, http:\/\/localhost\/homepage\/wp-content\/uploads\/2021\/06\/image-768x181.png 768w\" sizes=\"(max-width: 886px) 100vw, 886px\" \/><figcaption class=\"wp-element-caption\"><em>Experiment showing the promising OOD generalization ability of the bottleneck<\/em><\/figcaption><\/figure><\/div>\n\n\n<p><strong><span class=\"has-inline-color has-accent-color\">Interesting Q &amp; As:<\/span><\/strong><\/p>\n\n\n\n<p><strong>Q: Can you define what you mean by OOD in this work?<\/strong><\/p>\n\n\n\n<p>A: We focus on skills <em>transferrable<\/em> to totally different environments with <em>consistent dynamics<\/em>. This means the environmental dynamics that is sufficient for solving the in-distribution training tasks and the OOD evaluation tasks are consistently preserved, while the rest can be very different. Intuitively, we want to train our agent to be able to plan routes in the home city and expect this ability to be generalized to totally different municipality. The places can be very different, but the route planning skill depends on the knowledge that is quite universal.<\/p>\n\n\n\n<p><strong>Q: Why do you employ a non-static setting where environments change every episode?<\/strong><\/p>\n\n\n\n<p>A: Intuitively, the agent has no need to understand the dynamics of the task if the environment is fixed. Learning to memorize where to go and where not to is far easier than reasoning about what may happen. With the challenges, it became necessity for the agent to indeed learn and understand the environment dynamics, which is crucial for OOD evaluation.<\/p>\n\n\n\n<p><strong>Q: How do you avoid collapse in the state representation?<\/strong><\/p>\n\n\n\n<p>A: Apart from the training signal for dynamics, whose exclusive existence might cause collapse, all other training signals go through the common bottleneck of the encoder thus the representation is also shaped by the TD signals, the reward-termination prediction signals. We also want to mention that the regularizations participate in this as well.<\/p>\n\n\n\n<p><strong>Q: Why not use richer architectures for experiments?<\/strong><\/p>\n\n\n\n<p>A: Since there are already many components in the proposed agent, to isolate possible factors that would influence the agent behaviors, we use the minimal architecture sizes that marginally enables good RL performance on our test settings.<\/p>\n\n\n\n<p><strong>Q: Why not use MCTS as the search method for decision-time planning?<\/strong><\/p>\n\n\n\n<p>A: Unlike AlphaGo, which employs MCTS, our architecture is based on the simplest baseline DQN. DQN uses a value-estimator based greedy policy instead of a parameterized one as the actor-critic architecture used in AlphaGo. The DQN policy is deterministic <em>w.r.t.<\/em> the estimated values therefore the planning cannot take sufficient advantage of the sample based MCTS.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Mingde Zhao, Zhen Liu, Sitao Luan, Shuyuan Zhang, Doina Precup, Yoshua Bengio (arXiv \/ GitHub \/ YouTube) [NeurIPS 2021] This paper received media coverage from Synced Review, The Mila Blog (available in English &amp; French), MarkTechPost, etc. We introduce into reinforcement learning inductive biases inspired by higher-order cognitive functions in humans. These architectural constraints enable &#8230; <a title=\"A Consciousness-Inspired Planning Agent for Model-Based Reinforcement Learning\" class=\"read-more\" href=\"http:\/\/localhost\/homepage\/a-step-towards-conscious-planning\/\" aria-label=\"Read more about A Consciousness-Inspired Planning Agent for Model-Based Reinforcement Learning\">Read more<\/a><\/p>\n","protected":false},"author":1,"featured_media":213,"parent":0,"menu_order":0,"comment_status":"closed","ping_status":"closed","template":"","meta":{"footnotes":""},"_links":{"self":[{"href":"http:\/\/localhost\/homepage\/wp-json\/wp\/v2\/pages\/205"}],"collection":[{"href":"http:\/\/localhost\/homepage\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"http:\/\/localhost\/homepage\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/homepage\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/homepage\/wp-json\/wp\/v2\/comments?post=205"}],"version-history":[{"count":34,"href":"http:\/\/localhost\/homepage\/wp-json\/wp\/v2\/pages\/205\/revisions"}],"predecessor-version":[{"id":492,"href":"http:\/\/localhost\/homepage\/wp-json\/wp\/v2\/pages\/205\/revisions\/492"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/localhost\/homepage\/wp-json\/wp\/v2\/media\/213"}],"wp:attachment":[{"href":"http:\/\/localhost\/homepage\/wp-json\/wp\/v2\/media?parent=205"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}